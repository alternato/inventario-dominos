<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventario Domino's - Acceso</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root { --red: #E31837; --blue: #006491; }
        body {
            font-family: 'Segoe UI', sans-serif; height: 100vh; margin: 0;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            display: flex; justify-content: center; align-items: center; overflow: hidden;
        }
        /* --- Fichas Flotantes --- */
        .bg-shapes { position: absolute; width: 100%; height: 100%; z-index: -1; }
        .domino {
            position: absolute; width: 60px; height: 30px; background: var(--red);
            opacity: 0.15; border-radius: 4px; animation: float 8s ease-in-out infinite alternate;
        }
        .domino.blue { background: var(--blue); }
        @keyframes float { to { transform: translateY(-30px) rotate(10deg); } }
        /* Posiciones */
        .d1 { top: 10%; left: 10%; } .d2 { top: 50%; right: 10%; animation-delay: 1s; }
        .d3 { bottom: 20%; left: 20%; } .d4 { top: 20%; right: 30%; }

        /* --- Tarjeta Login --- */
        .card {
            background: rgba(255,255,255,0.95); padding: 40px; border-radius: 15px;
            width: 100%; max-width: 380px; text-align: center;
            border-top: 6px solid var(--red); box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        input { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; }
        .btn { width: 100%; padding: 12px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; margin-top: 10px; }
        .btn-blue { background: var(--blue); color: white; }
        .btn-ms { background: #2F2F2F; color: white; display: flex; justify-content: center; gap: 10px; }
        .divider { margin: 20px 0; color: #888; font-size: 0.8em; display: flex; align-items: center; }
        .divider::before, .divider::after { content: ""; flex: 1; height: 1px; background: #ddd; margin: 0 10px; }
    </style>
</head>
<body>
    <div class="bg-shapes">
        <div class="domino d1"></div><div class="domino blue d2"></div>
        <div class="domino d3"></div><div class="domino blue d4"></div>
    </div>

    <div class="card">
        <h2 style="color:var(--blue); margin-top:0;">Inventario Domino's</h2>
        
        <input type="email" id="email" placeholder="Correo electrónico">
        <input type="password" id="pass" placeholder="Contraseña">
        <button onclick="loginEmail()" class="btn btn-blue">Ingresar</button>

        <div class="divider">O ingresa con</div>

        <button onclick="loginMicrosoft()" class="btn btn-ms">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="white"><path d="M0 0h11v11H0zM13 0h11v11H13zM0 13h11v11H0zM13 13h11v11H13z"/></svg>
            Cuenta Corporativa
        </button>
        <p id="msg" style="color: red; font-size: 0.9em; min-height: 20px;"></p>
    </div>

    <script>
        // --- PEGA TUS LLAVES AQUÍ ---
        const SB_URL = 'https://ivjwxvhixrskraepqzse.supabase.co';
        const SB_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml2and4dmhpeHJza3JhZXBxenNlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg5MjgxNTgsImV4cCI6MjA4NDUwNDE1OH0.QzgNSwqf6VTXZjGMXOAfUnjW4f1mJcRqECxxNnLZc-o';
        
        const sb = supabase.createClient(SB_URL, SB_KEY);

        // 1. Al cargar, si ya hay usuario, mándalo al Dashboard
        window.onload = async () => {
            const { data: { session } } = await sb.auth.getSession();
            if (session) window.location.href = 'dashboard.html';
        };

        // 2. Login con Email
        async function loginEmail() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('pass').value;
            const { error } = await sb.auth.signInWithPassword({ email, password });
            if (error) document.getElementById('msg').innerText = error.message;
            else window.location.href = 'dashboard.html';
        }

        // 3. Login con Microsoft
        async function loginMicrosoft() {
            await sb.auth.signInWithOAuth({
                provider: 'azure',
                options: {
                    scopes: 'email',
                    queryParams: { prompt: 'select_account' },
                    // IMPORTANTE: Asegúrate de que esta URL sea la de tu repo en GitHub
                    redirectTo: 'https://alternato.github.io/inventario-dominos/' 
                }
            });
        }
    </script>
</body>
</html>
